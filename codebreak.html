<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Medical Terminology - Break the Code</title>
  <style>
    :root {
      --bg-gradient: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      --glass-bg: rgba(255, 255, 255, 0.08);
      --glass-border: rgba(255, 255, 255, 0.15);
      --accent: #00d4ff;
      --correct: #00ff9d;
      --wrong: #ff4d6d;
      --text: #e0f7ff;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    html, body {
      height:100%; font-family: system-ui, -apple-system, sans-serif;
      background: var(--bg-gradient); color: var(--text);
      overflow:hidden; touch-action: manipulation;
    }
    #ui {
      position: absolute; inset:0;
      background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="3" /><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.05 0"/></filter><rect width="100" height="100" filter="url(%23n)" opacity="0.07"/></svg>') repeat,
                  var(--bg-gradient);
      backdrop-filter: blur(1px);
    }
    #overlay { position:absolute; inset:0; pointer-events:none; }
    #questionBox {
      position: absolute; top: 8vh; left: 5vw; right: 5vw;
      background: var(--glass-bg); backdrop-filter: blur(16px);
      border: 1px solid var(--glass-border); border-radius: 24px;
      padding: 24px 20px; box-shadow: 0 8px 32px rgba(0,0,0,0.4);
      text-align: center; font-size: 1.1rem; line-height: 1.5;
      max-height: 70vh; overflow-y: auto;
    }
    .term { 
      color: var(--accent); 
      font-weight: bold; 
      cursor: pointer; 
      text-decoration: underline; 
      transition: transform 0.2s;
    }
    .term.expanded { 
      font-size: 2rem !important; 
      background: rgba(0,212,255,0.2); 
      border-radius: 12px; 
      padding: 8px 16px !important;
      display: inline-block;
      transform: scale(1.1);
    }
    #pieces { display: flex; flex-wrap: wrap; justify-content: center; gap: 12px; margin: 20px 0; min-height: 60px; }
    .piece {
      background: rgba(255,255,255,0.12); backdrop-filter: blur(8px);
      border: 1px solid var(--glass-border); border-radius: 12px;
      padding: 12px 18px; font-size: 1.2rem; cursor: grab; user-select: none;
      transition: all 0.2s;
    }
    .piece:active { transform: scale(1.1); box-shadow: 0 0 20px var(--accent); }
    .dropzone {
      background: rgba(0,0,0,0.2); border: 2px dashed var(--accent);
      border-radius: 16px; padding: 16px; margin: 12px auto; width: 90%;
      min-height: 80px; display: flex; flex-wrap: wrap; gap: 10px;
      font-weight: bold; color: var(--accent);
    }
    .meaning-pool { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin: 20px 0; }
    .meaning {
      background: rgba(255,255,255,0.1); padding: 10px 16px; border-radius: 20px;
      cursor: grab; transition: 0.2s;
    }
    .meaning.correct { background: var(--correct); color: black; }
    input[type="text"] {
      width: 90%; padding: 14px; margin: 16px auto; display: block;
      background: rgba(255,255,255,0.15); border: none; border-radius: 12px;
      color: white; font-size: 1.1rem; text-align: center;
    }
    button { 
      background: linear-gradient(45deg, #00d4ff, #0095ff);
      border: none; color: white; font-size: 1.2rem; padding: 14px 32px;
      border-radius: 50px; margin: 16px; cursor: pointer; box-shadow: 0 4px 20px rgba(0,212,255,0.4);
      transition: transform 0.15s;
    }
    button:active { transform: scale(0.96); }
    #scoreBoard {
      position: absolute; top: 2vh; right: 4vw; background: var(--glass-bg);
      backdrop-filter: blur(12px); padding: 10px 16px; border-radius: 16px;
      font-size: 1.1rem; border: 1px solid var(--glass-border);
    }
    #particles { position:absolute; inset:0; pointer-events:none; }
    .hidden { display:none !important; }
    @keyframes shake { 0%,100% {transform:translateX(0);} 25%{transform:translateX(-5px);} 75%{transform:translateX(5px);} }
  </style>
</head>
<body>

<canvas id="overlay"></canvas>
<canvas id="particles"></canvas>

<div id="ui">
  <div id="scoreBoard">Score: 0 | Question: 1/10 | Time: 0s</div>
  <div id="questionBox">
    <h2>Welcome!</h2>
    <p>Tap "Start" to get 10 random terms.<br>Use your medical dictionary/notes — no Google!</p>
    <button onclick="startGame()">Start Session</button>
  </div>
</div>

<script>
// ──────────────────────────────────────────────── Data
const allQuestions = [
  { id:1, sentence:"The patient was <span class='term' data-term='hypoglycaemic'>hypoglycaemic</span>", answerBreak:"hypo/glyc/aem/ic", meanings:["low","sugar","blood","pertaining to"], explanation:"low blood sugar" },
  { id:2, sentence:"There was swelling in the <span class='term' data-term='interphalangeal'>interphalangeal</span> joints", answerBreak:"inter/phalange/al", meanings:["between","finger or toe bones","pertaining to"], explanation:"the joints in the fingers or toes (not knuckles)" },
  { id:3, sentence:"The young girl experienced <span class='term' data-term='tachycardia'>tachycardia</span>", answerBreak:"tachy/cardia", meanings:["fast","heart"], explanation:"a rapidly beating heart" },
  { id:4, sentence:"The patient underwent a <span class='term' data-term='cholecystectomy'>cholecystectomy</span>", answerBreak:"chole/cyst/ec/tom/y", meanings:["bile","bag","out","cut","process of"], explanation:"surgical removal of the gall bladder" },
  { id:5, sentence:"The results showed <span class='term' data-term='glycosuria'>glycosuria</span>", answerBreak:"glycos/uria", meanings:["sugar","urine"], explanation:"sugar in the urine" },
  { id:6, sentence:"The patient had <span class='term' data-term='hepatosplenomegaly'>hepatosplenomegaly</span>", answerBreak:"hepato/spleno/mega/ly", meanings:["liver","spleen","bigger","condition of"], explanation:"an enlarged liver & spleen" },
  { id:7, sentence:"The patient reported <span class='term' data-term='polyarthralgia'>polyarthralgia</span>", answerBreak:"poly/arthr/algia", meanings:["many","joint","pain"], explanation:"pain in several joints" },
  { id:8, sentence:"Referral was made to a <span class='term' data-term='neurologist'>neurologist</span>", answerBreak:"neuro/log/ist", meanings:["brain or nervous system","study of","specialist"], explanation:"a specialist of the brain/nervous system" },
  { id:9, sentence:"The doctor ordered an <span class='term' data-term='electrocardiograph'>electrocardiograph</span>", answerBreak:"electro/cardio/graph", meanings:["electrical","heart","picture"], explanation:"a image showing electrical impulses of the heart" },
  { id:10, sentence:"A <span class='term' data-term='tympanostomy'>tympanostomy</span> was performed", answerBreak:"tympano/stomy", meanings:["ear drum","hole cut into"], explanation:"surgically made a hole in the ear drum usually to release fluids" },
  { id:11, sentence:"The patient showed signs consistent with <span class='term' data-term='adenoid hypertrophy'>adenoid hypertrophy</span>", special:"adenoid", answerBreak:"hyper/trophy", meanings:["above","growth"], explanation:"overgrown or enlarged" },
  { id:12, sentence:"The sample was sent to the <span class='term' data-term='histopathology'>histopathology</span> clinic", answerBreak:"histo/patho/logy", meanings:["tissues","disease","study of"], explanation:"study of disease in tissues" },
  { id:13, sentence:"There was a risk of <span class='term' data-term='gastritis'>gastritis</span>", answerBreak:"gastr/itis", meanings:["stomach","inflammation of"], explanation:"inflammation of the stomach" },
  { id:14, sentence:"The doctor diagnosed her with <span class='term' data-term='cardiomyopathy'>cardiomyopathy</span>", answerBreak:"cardio/myo/pathy", meanings:["heart","muscle","disease"], explanation:"disease of the heart muscle" },
  { id:15, sentence:"The patient underwent a partial pulmonary <span class='term' data-term='lobectomy'>lobectomy</span>", special:"pulmonary", answerBreak:"lob/ec/tom/y", meanings:["lobe","out","cut","process of"], explanation:"cut out one lobe of the lung" },
  { id:16, sentence:"The patient attended <span class='term' data-term='antenatal'>antenatal</span> classes", answerBreak:"ante/natal", meanings:["before","birth"], explanation:"before birth" },
  { id:17, sentence:"The <span class='term' data-term='melanoma'>melanoma</span> measured 7 mm across", answerBreak:"melan/oma", meanings:["dark","tumour"], explanation:"dark tumour" },
  { id:18, sentence:"The patient had a transient <span class='term' data-term='ischaemic'>ischaemic</span> attack", special:"TIA (transient ischaemic attack)", answerBreak:"isc/haemic", meanings:["stop","blood"], explanation:"a blockage in blood flow, TIA also commonly called stroke if the TIA is in the brain" },
  { id:19, sentence:"Renal <span class='term' data-term='pyelography'>pyelography</span> confirmed stones were present", answerBreak:"pyelo/graphy", meanings:["pelvis","picture"], explanation:"imaging of the renal pelvis" },
  { id:20, sentence:"The patient was found to have <span class='term' data-term='osteoporosis'>osteoporosis</span>", answerBreak:"osteo/por/osis", meanings:["bone","hole","condition of"], explanation:"condition of porous bones" },
  { id:21, sentence:"The patient suffered from a generalised <span class='term' data-term='lymphadenopathy'>lymphadenopathy</span>", answerBreak:"lymph/adeno/pathy", meanings:["lymph","gland","disease"], explanation:"disease of the lymph glands" },
  { id:22, sentence:"The patient suffered from <span class='term' data-term='dysentery'>dysentery</span>", answerBreak:"dys/enter/y", meanings:["bad or poor","small intestines","process of"], explanation:"something wrong with small intestines" },
  { id:23, sentence:"The impact resulted in <span class='term' data-term='intracranial'>intracranial</span> bleeding", answerBreak:"intra/cranial", meanings:["inside","skull"], explanation:"bleeding inside the skull" },
  { id:24, sentence:"Elderly people often have <span class='term' data-term='atherosclerosis'>atherosclerosis</span>", answerBreak:"athero/scler/osis", meanings:["fatty plaque","dry or hard","condition of"], explanation:"usually relating to the arteries & veins that have become hardened and coated in fatty plaques" },
  { id:25, sentence:"An <span class='term' data-term='tracheotomy'>tracheotomy</span> was performed", answerBreak:"trachea/tom/y", meanings:["wind pipe","cut","process of"], explanation:"cut into the windpipe" },
  { id:26, sentence:"The patient developed <span class='term' data-term='hyperglycaemia'>hyperglycaemia</span>", answerBreak:"hyper/glyc/aem/ia", meanings:["above","sugar","blood","condition of"], explanation:"high blood sugar" }
];

let questions = []; let current = 0; let score = 0; let startTime = null; let timerInterval;
const qBox = document.getElementById('questionBox');
const overlay = document.getElementById('overlay');
const ctx =
